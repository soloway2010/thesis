(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     64215,       1776]
NotebookOptionsPosition[     60356,       1650]
NotebookOutlinePosition[     60693,       1665]
CellTagsIndexPosition[     60650,       1662]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"inputPoint", "[", "pid_", "]"}], " ", ":=", " ", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{"Symbol", "[", "  ", 
     RowBox[{
      RowBox[{"ToString", "[", "pid", "]"}], " ", "<>", " ", "\"\<x\>\""}], 
     " ", "]"}], ",", 
    RowBox[{"Symbol", "[", "  ", 
     RowBox[{
      RowBox[{"ToString", "[", "pid", "]"}], " ", "<>", " ", "\"\<y\>\""}], 
     " ", "]"}], ",", 
    RowBox[{"Symbol", "[", " ", 
     RowBox[{
      RowBox[{"ToString", "[", "pid", "]"}], " ", "<>", " ", "\"\<z\>\""}], 
     " ", "]"}], " ", ",", "1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.700073477232725*^9, 3.700073521993874*^9}, {
  3.700073556672625*^9, 3.700073597139331*^9}, {3.700128902609871*^9, 
  3.700128902828915*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"epsV", "[", "meshId_", "]"}], " ", ":=", " ", 
  RowBox[{"{", "  ", 
   RowBox[{
    RowBox[{"meshId", "*", "\[Epsilon]"}], ",", " ", 
    RowBox[{"meshId", "*", 
     RowBox[{"\[Epsilon]", "^", "2"}]}], ",", " ", 
    RowBox[{"meshId", "*", 
     RowBox[{"\[Epsilon]", "^", "3"}]}], " ", ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.700091750314432*^9, 3.700091760116716*^9}, {
  3.700091797168929*^9, 3.700091800243514*^9}, {3.7000957544273252`*^9, 
  3.700095756064571*^9}, {3.700128918884532*^9, 3.700128919143865*^9}, {
  3.700129086793021*^9, 3.7001291055736732`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", "[", "meshId_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"inputPoint", "[", "a", "]"}], " ", "+", " ", 
   RowBox[{"epsV", "[", "meshId", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7000736187530212`*^9, 3.700073637548019*^9}, 
   3.700074957851506*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"b", "[", "meshId_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"inputPoint", "[", "b", "]"}], " ", "+", " ", 
   RowBox[{"epsV", "[", "meshId", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7000736390519342`*^9, 3.7000736548267317`*^9}, {
  3.700074959311119*^9, 3.700074959489897*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", "[", "meshId_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"inputPoint", "[", "c", "]"}], " ", "+", " ", 
   RowBox[{"epsV", "[", "meshId", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.700073663763648*^9, 3.700073665716579*^9}, 
   3.700074961602983*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "[", "meshId_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"inputPoint", "[", "d", "]"}], " ", "+", " ", 
   RowBox[{"epsV", "[", "meshId", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7001289647327633`*^9, 3.700128966007316*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkCoPlanar", "[", "meshIdD_", "]"}], " ", ":=", " ", 
  RowBox[{"{", " ", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"1", "-", "meshIdD"}], "]"}], ",", " ", 
    RowBox[{"b", "[", 
     RowBox[{"1", "-", "meshIdD"}], "]"}], ",", 
    RowBox[{"c", "[", "meshIdD", "]"}], ",", 
    RowBox[{"d", "[", "meshIdD", "]"}]}], " ", "}"}]}]], "Input",
 CellChangeTimes->{{3.7001289796197643`*^9, 3.700129035908848*^9}, {
   3.700129068057041*^9, 3.700129075822487*^9}, {3.7001324412385263`*^9, 
   3.700132441498629*^9}, 3.70013691993073*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkIfParallel", "[", "meshId_", "]"}], " ", ":=", " ", 
  RowBox[{"Cross", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"b", "[", 
        RowBox[{"1", "-", "meshIdD"}], "]"}], "-", 
       RowBox[{"a", "[", 
        RowBox[{"1", "-", "meshIdD"}], "]"}]}], ")"}], " ", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "3"}], "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"d", "[", "meshIdD", "]"}], "-", 
       RowBox[{"c", "[", "meshIdD", "]"}]}], ")"}], " ", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7001289796197643`*^9, 3.700129035908848*^9}, {
  3.700129068057041*^9, 3.700129075822487*^9}, {3.7001324412385263`*^9, 
  3.700132441498629*^9}, {3.70013691993073*^9, 3.700136972897748*^9}, {
  3.7001530635970087`*^9, 3.700153102668887*^9}, {3.700153150883202*^9, 
  3.700153152769874*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkCoPlanar", "[", "0", "]"}]], "Input",
 CellChangeTimes->{{3.700129043606577*^9, 3.700129044207656*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ax", "+", "\[Epsilon]"}], ",", 
     RowBox[{"ay", "+", 
      SuperscriptBox["\[Epsilon]", "2"]}], ",", 
     RowBox[{"az", "+", 
      SuperscriptBox["\[Epsilon]", "3"]}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bx", "+", "\[Epsilon]"}], ",", 
     RowBox[{"by", "+", 
      SuperscriptBox["\[Epsilon]", "2"]}], ",", 
     RowBox[{"bz", "+", 
      SuperscriptBox["\[Epsilon]", "3"]}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"cx", ",", "cy", ",", "cz", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"dx", ",", "dy", ",", "dz", ",", "1"}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.700129045071457*^9, 3.700129107515851*^9}, 
   3.700130442683172*^9, 3.700130629345746*^9, 3.700130708160972*^9, 
   3.700130894045528*^9, 3.7001324491374407`*^9, 3.700132661237735*^9, 
   3.700132721474465*^9, 3.70013487435686*^9, {3.70015316563484*^9, 
   3.7001531863491707`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkIfParallel", "[", "0", "]"}]], "Input",
 CellChangeTimes->{{3.700129130253914*^9, 3.7001291763219013`*^9}, {
   3.7001292322123547`*^9, 3.700129282154982*^9}, {3.700129386725812*^9, 
   3.7001293879395313`*^9}, 3.7001295896489677`*^9, {3.700129629418633*^9, 
   3.700129637479518*^9}, {3.700132699324259*^9, 3.700132701811747*^9}, {
   3.700145200431768*^9, 3.7001452204462442`*^9}, {3.700153075796109*^9, 
   3.700153078338346*^9}, {3.700153129499064*^9, 3.700153163713085*^9}, {
   3.70015785345126*^9, 3.700157854708152*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "az"}], " ", "cy"}], "+", 
    RowBox[{"bz", " ", "cy"}], "+", 
    RowBox[{"ay", " ", "cz"}], "-", 
    RowBox[{"by", " ", "cz"}], "+", 
    RowBox[{"az", " ", "dy"}], "-", 
    RowBox[{"bz", " ", "dy"}], "-", 
    RowBox[{"ay", " ", "dz"}], "+", 
    RowBox[{"by", " ", "dz"}]}], ",", 
   RowBox[{
    RowBox[{"az", " ", "cx"}], "-", 
    RowBox[{"bz", " ", "cx"}], "-", 
    RowBox[{"ax", " ", "cz"}], "+", 
    RowBox[{"bx", " ", "cz"}], "-", 
    RowBox[{"az", " ", "dx"}], "+", 
    RowBox[{"bz", " ", "dx"}], "+", 
    RowBox[{"ax", " ", "dz"}], "-", 
    RowBox[{"bx", " ", "dz"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "ay"}], " ", "cx"}], "+", 
    RowBox[{"by", " ", "cx"}], "+", 
    RowBox[{"ax", " ", "cy"}], "-", 
    RowBox[{"bx", " ", "cy"}], "+", 
    RowBox[{"ay", " ", "dx"}], "-", 
    RowBox[{"by", " ", "dx"}], "-", 
    RowBox[{"ax", " ", "dy"}], "+", 
    RowBox[{"bx", " ", "dy"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.700157855643972*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dIsOnPlane", " ", "=", " ", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"Solve", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Det", "[", 
        RowBox[{"checkCoPlanar", "[", "0", "]"}], "]"}], "\[Equal]", "0"}], 
      ",", " ", "dz"}], " ", "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.700129130253914*^9, 3.7001291763219013`*^9}, {
   3.7001292322123547`*^9, 3.700129282154982*^9}, {3.700129386725812*^9, 
   3.7001293879395313`*^9}, 3.7001295896489677`*^9, {3.700129629418633*^9, 
   3.700129637479518*^9}, {3.700132699324259*^9, 3.700132701811747*^9}, {
   3.700145200431768*^9, 3.7001452204462442`*^9}, 3.700153075796109*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dz", "\[Rule]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "ax"}], " ", "bz", " ", "cy"}], "+", 
      RowBox[{"ax", " ", "by", " ", "cz"}], "+", 
      RowBox[{"bz", " ", "cy", " ", "dx"}], "-", 
      RowBox[{"by", " ", "cz", " ", "dx"}], "+", 
      RowBox[{"ax", " ", "bz", " ", "dy"}], "-", 
      RowBox[{"bz", " ", "cx", " ", "dy"}], "-", 
      RowBox[{"ax", " ", "cz", " ", "dy"}], "+", 
      RowBox[{"bx", " ", "cz", " ", "dy"}], "-", 
      RowBox[{"bz", " ", "cy", " ", "\[Epsilon]"}], "+", 
      RowBox[{"by", " ", "cz", " ", "\[Epsilon]"}], "+", 
      RowBox[{"bz", " ", "dy", " ", "\[Epsilon]"}], "+", 
      RowBox[{"bz", " ", "cx", " ", 
       SuperscriptBox["\[Epsilon]", "2"]}], "+", 
      RowBox[{"ax", " ", "cz", " ", 
       SuperscriptBox["\[Epsilon]", "2"]}], "-", 
      RowBox[{"bx", " ", "cz", " ", 
       SuperscriptBox["\[Epsilon]", "2"]}], "-", 
      RowBox[{"bz", " ", "dx", " ", 
       SuperscriptBox["\[Epsilon]", "2"]}], "-", 
      RowBox[{"by", " ", "cx", " ", 
       SuperscriptBox["\[Epsilon]", "3"]}], "-", 
      RowBox[{"ax", " ", "cy", " ", 
       SuperscriptBox["\[Epsilon]", "3"]}], "+", 
      RowBox[{"bx", " ", "cy", " ", 
       SuperscriptBox["\[Epsilon]", "3"]}], "+", 
      RowBox[{"by", " ", "dx", " ", 
       SuperscriptBox["\[Epsilon]", "3"]}], "+", 
      RowBox[{"ax", " ", "dy", " ", 
       SuperscriptBox["\[Epsilon]", "3"]}], "-", 
      RowBox[{"bx", " ", "dy", " ", 
       SuperscriptBox["\[Epsilon]", "3"]}], "+", 
      RowBox[{"az", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"bx", " ", "cy"}], "-", 
         RowBox[{"cy", " ", "dx"}], "+", 
         RowBox[{"by", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "cx"}], "+", "dx"}], ")"}]}], "-", 
         RowBox[{"bx", " ", "dy"}], "+", 
         RowBox[{"cx", " ", "dy"}], "+", 
         RowBox[{"cy", " ", "\[Epsilon]"}], "-", 
         RowBox[{"dy", " ", "\[Epsilon]"}], "-", 
         RowBox[{"cx", " ", 
          SuperscriptBox["\[Epsilon]", "2"]}], "+", 
         RowBox[{"dx", " ", 
          SuperscriptBox["\[Epsilon]", "2"]}]}], ")"}]}], "+", 
      RowBox[{"ay", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"bz", " ", "cx"}], "-", 
         RowBox[{"bx", " ", "cz"}], "-", 
         RowBox[{"bz", " ", "dx"}], "+", 
         RowBox[{"cz", " ", "dx"}], "-", 
         RowBox[{"cz", " ", "\[Epsilon]"}], "+", 
         RowBox[{"cx", " ", 
          SuperscriptBox["\[Epsilon]", "3"]}], "-", 
         RowBox[{"dx", " ", 
          SuperscriptBox["\[Epsilon]", "3"]}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "by"}], " ", "cx"}], "+", 
      RowBox[{"bx", " ", "cy"}], "+", 
      RowBox[{"by", " ", "\[Epsilon]"}], "-", 
      RowBox[{"bx", " ", 
       SuperscriptBox["\[Epsilon]", "2"]}], "-", 
      RowBox[{"ay", " ", 
       RowBox[{"(", 
        RowBox[{"bx", "-", "cx", "+", "\[Epsilon]"}], ")"}]}], "+", 
      RowBox[{"ax", " ", 
       RowBox[{"(", 
        RowBox[{"by", "-", "cy", "+", 
         SuperscriptBox["\[Epsilon]", "2"]}], ")"}]}]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.700129137952179*^9, 3.700129177105104*^9, {3.700129233603836*^9, 
   3.700129282833228*^9}, 3.700129389573481*^9, 3.700129590362916*^9, 
   3.700129638721943*^9, 3.7001304427352467`*^9, 3.7001306295950403`*^9, 
   3.700130708240821*^9, 3.700130894183551*^9, 3.700132449316834*^9, 
   3.700132661349218*^9, {3.700132702305502*^9, 3.700132721553598*^9}, 
   3.7001348744196177`*^9, {3.700145203621916*^9, 3.70014522129908*^9}, {
   3.700153165822762*^9, 3.700153186835885*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", " ", "=", "  ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"dIsOnPlane", " ", "/.", 
     RowBox[{"Rule", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"#2", "&"}], ")"}]}]}], ")"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.7001296412689667`*^9, 3.700129695459322*^9}, {
  3.700129914490703*^9, 3.700129915013247*^9}, {3.700132497256473*^9, 
  3.700132499882744*^9}, {3.7001325394284353`*^9, 3.700132637152289*^9}, {
  3.7001452073610363`*^9, 3.700145225594769*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "ax"}], " ", "bz", " ", "cy"}], "+", 
    RowBox[{"ax", " ", "by", " ", "cz"}], "+", 
    RowBox[{"bz", " ", "cy", " ", "dx"}], "-", 
    RowBox[{"by", " ", "cz", " ", "dx"}], "+", 
    RowBox[{"ax", " ", "bz", " ", "dy"}], "-", 
    RowBox[{"bz", " ", "cx", " ", "dy"}], "-", 
    RowBox[{"ax", " ", "cz", " ", "dy"}], "+", 
    RowBox[{"bx", " ", "cz", " ", "dy"}], "-", 
    RowBox[{"bz", " ", "cy", " ", "\[Epsilon]"}], "+", 
    RowBox[{"by", " ", "cz", " ", "\[Epsilon]"}], "+", 
    RowBox[{"bz", " ", "dy", " ", "\[Epsilon]"}], "+", 
    RowBox[{"bz", " ", "cx", " ", 
     SuperscriptBox["\[Epsilon]", "2"]}], "+", 
    RowBox[{"ax", " ", "cz", " ", 
     SuperscriptBox["\[Epsilon]", "2"]}], "-", 
    RowBox[{"bx", " ", "cz", " ", 
     SuperscriptBox["\[Epsilon]", "2"]}], "-", 
    RowBox[{"bz", " ", "dx", " ", 
     SuperscriptBox["\[Epsilon]", "2"]}], "-", 
    RowBox[{"by", " ", "cx", " ", 
     SuperscriptBox["\[Epsilon]", "3"]}], "-", 
    RowBox[{"ax", " ", "cy", " ", 
     SuperscriptBox["\[Epsilon]", "3"]}], "+", 
    RowBox[{"bx", " ", "cy", " ", 
     SuperscriptBox["\[Epsilon]", "3"]}], "+", 
    RowBox[{"by", " ", "dx", " ", 
     SuperscriptBox["\[Epsilon]", "3"]}], "+", 
    RowBox[{"ax", " ", "dy", " ", 
     SuperscriptBox["\[Epsilon]", "3"]}], "-", 
    RowBox[{"bx", " ", "dy", " ", 
     SuperscriptBox["\[Epsilon]", "3"]}], "+", 
    RowBox[{"az", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"bx", " ", "cy"}], "-", 
       RowBox[{"cy", " ", "dx"}], "+", 
       RowBox[{"by", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "cx"}], "+", "dx"}], ")"}]}], "-", 
       RowBox[{"bx", " ", "dy"}], "+", 
       RowBox[{"cx", " ", "dy"}], "+", 
       RowBox[{"cy", " ", "\[Epsilon]"}], "-", 
       RowBox[{"dy", " ", "\[Epsilon]"}], "-", 
       RowBox[{"cx", " ", 
        SuperscriptBox["\[Epsilon]", "2"]}], "+", 
       RowBox[{"dx", " ", 
        SuperscriptBox["\[Epsilon]", "2"]}]}], ")"}]}], "+", 
    RowBox[{"ay", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"bz", " ", "cx"}], "-", 
       RowBox[{"bx", " ", "cz"}], "-", 
       RowBox[{"bz", " ", "dx"}], "+", 
       RowBox[{"cz", " ", "dx"}], "-", 
       RowBox[{"cz", " ", "\[Epsilon]"}], "+", 
       RowBox[{"cx", " ", 
        SuperscriptBox["\[Epsilon]", "3"]}], "-", 
       RowBox[{"dx", " ", 
        SuperscriptBox["\[Epsilon]", "3"]}]}], ")"}]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "by"}], " ", "cx"}], "+", 
    RowBox[{"bx", " ", "cy"}], "+", 
    RowBox[{"by", " ", "\[Epsilon]"}], "-", 
    RowBox[{"bx", " ", 
     SuperscriptBox["\[Epsilon]", "2"]}], "-", 
    RowBox[{"ay", " ", 
     RowBox[{"(", 
      RowBox[{"bx", "-", "cx", "+", "\[Epsilon]"}], ")"}]}], "+", 
    RowBox[{"ax", " ", 
     RowBox[{"(", 
      RowBox[{"by", "-", "cy", "+", 
       SuperscriptBox["\[Epsilon]", "2"]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.700129639536998*^9, 3.7001297024873466`*^9}, 
   3.700129916934023*^9, 3.700130442786435*^9, 3.700130629657095*^9, 
   3.700130708297131*^9, 3.7001308943324757`*^9, 3.700132449433078*^9, {
   3.7001325248234158`*^9, 3.7001326614426193`*^9}, {3.7001327057534103`*^9, 
   3.7001327216093884`*^9}, 3.7001348744678583`*^9, {3.7001452084478073`*^9, 
   3.700145226371676*^9}, {3.7001531658840446`*^9, 3.700153187364077*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", "expr", "]"}], ",", "\[Epsilon]"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.7001327091336613`*^9, {3.700133589736723*^9, 3.700133633206964*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"az", " ", "by", " ", "cx"}], "-", 
    RowBox[{"ay", " ", "bz", " ", "cx"}], "-", 
    RowBox[{"az", " ", "bx", " ", "cy"}], "+", 
    RowBox[{"ax", " ", "bz", " ", "cy"}], "+", 
    RowBox[{"ay", " ", "bx", " ", "cz"}], "-", 
    RowBox[{"ax", " ", "by", " ", "cz"}], "-", 
    RowBox[{"az", " ", "by", " ", "dx"}], "+", 
    RowBox[{"ay", " ", "bz", " ", "dx"}], "+", 
    RowBox[{"az", " ", "cy", " ", "dx"}], "-", 
    RowBox[{"bz", " ", "cy", " ", "dx"}], "-", 
    RowBox[{"ay", " ", "cz", " ", "dx"}], "+", 
    RowBox[{"by", " ", "cz", " ", "dx"}], "+", 
    RowBox[{"az", " ", "bx", " ", "dy"}], "-", 
    RowBox[{"ax", " ", "bz", " ", "dy"}], "-", 
    RowBox[{"az", " ", "cx", " ", "dy"}], "+", 
    RowBox[{"bz", " ", "cx", " ", "dy"}], "+", 
    RowBox[{"ax", " ", "cz", " ", "dy"}], "-", 
    RowBox[{"bx", " ", "cz", " ", "dy"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ay", "-", "by"}], ")"}], " ", "cz"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"az", "-", "bz"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"cy", "-", "dy"}], ")"}]}]}], ")"}], " ", "\[Epsilon]"}], 
    "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "ax"}], "+", "bx"}], ")"}], " ", "cz"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"az", "-", "bz"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"cx", "-", "dx"}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox["\[Epsilon]", "2"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"ay", "-", "by"}], ")"}]}], " ", 
        RowBox[{"(", 
         RowBox[{"cx", "-", "dx"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ax", "-", "bx"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"cy", "-", "dy"}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox["\[Epsilon]", "3"]}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"by", " ", "cx"}], "-", 
    RowBox[{"bx", " ", "cy"}], "-", 
    RowBox[{"by", " ", "\[Epsilon]"}], "+", 
    RowBox[{"bx", " ", 
     SuperscriptBox["\[Epsilon]", "2"]}], "+", 
    RowBox[{"ay", " ", 
     RowBox[{"(", 
      RowBox[{"bx", "-", "cx", "+", "\[Epsilon]"}], ")"}]}], "-", 
    RowBox[{"ax", " ", 
     RowBox[{"(", 
      RowBox[{"by", "-", "cy", "+", 
       SuperscriptBox["\[Epsilon]", "2"]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.70013361614004*^9, 3.700133633873886*^9}, 
   3.7001348745182657`*^9, {3.700153166648406*^9, 3.7001531879335737`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"numerator", " ", "=", " ", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"expr", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", "\[Epsilon]"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.700129607259149*^9, 3.700129636109511*^9}, {
   3.700129960881805*^9, 3.700130104516369*^9}, 3.700130170986486*^9, {
   3.700130272908341*^9, 3.700130309699768*^9}, {3.700130361604932*^9, 
   3.700130394700654*^9}, {3.700130456690378*^9, 3.7001304647021303`*^9}, {
   3.700132646309293*^9, 3.7001326552276173`*^9}, {3.700132740765851*^9, 
   3.7001327409301023`*^9}, {3.700132792466167*^9, 3.700132800636036*^9}, {
   3.7001328448805227`*^9, 3.700132850380398*^9}, {3.7001332975937862`*^9, 
   3.700133298146152*^9}, {3.700134336094614*^9, 3.7001343380804033`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ay", " ", "bz", " ", "cx"}], "+", 
  RowBox[{"az", " ", "bx", " ", "cy"}], "-", 
  RowBox[{"ax", " ", "bz", " ", "cy"}], "-", 
  RowBox[{"ay", " ", "bx", " ", "cz"}], "+", 
  RowBox[{"ax", " ", "by", " ", "cz"}], "-", 
  RowBox[{"ay", " ", "bz", " ", "dx"}], "-", 
  RowBox[{"az", " ", "cy", " ", "dx"}], "+", 
  RowBox[{"bz", " ", "cy", " ", "dx"}], "+", 
  RowBox[{"ay", " ", "cz", " ", "dx"}], "-", 
  RowBox[{"by", " ", "cz", " ", "dx"}], "+", 
  RowBox[{"az", " ", "by", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "cx"}], "+", "dx"}], ")"}]}], "-", 
  RowBox[{"az", " ", "bx", " ", "dy"}], "+", 
  RowBox[{"ax", " ", "bz", " ", "dy"}], "+", 
  RowBox[{"az", " ", "cx", " ", "dy"}], "-", 
  RowBox[{"bz", " ", "cx", " ", "dy"}], "-", 
  RowBox[{"ax", " ", "cz", " ", "dy"}], "+", 
  RowBox[{"bx", " ", "cz", " ", "dy"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "ay"}], "+", "by"}], ")"}], " ", "cz"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"az", "-", "bz"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"cy", "-", "dy"}], ")"}]}]}], ")"}], " ", "\[Epsilon]"}], "+", 
  
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ax", "-", "bx"}], ")"}], " ", "cz"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"az", "-", "bz"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"cx", "-", "dx"}], ")"}]}]}], ")"}], " ", 
   SuperscriptBox["\[Epsilon]", "2"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ay", "-", "by"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"cx", "-", "dx"}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ax", "-", "bx"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"cy", "-", "dy"}], ")"}]}]}], ")"}], " ", 
   SuperscriptBox["\[Epsilon]", "3"]}]}]], "Output",
 CellChangeTimes->{
  3.700129997930435*^9, {3.70013006422318*^9, 3.7001301051511707`*^9}, 
   3.70013017217867*^9, {3.700130274682498*^9, 3.700130310146388*^9}, {
   3.700130369013973*^9, 3.7001304658380527`*^9}, 3.700130629897472*^9, 
   3.700130708368925*^9, 3.700130894608511*^9, 3.700132449677491*^9, {
   3.700132655943981*^9, 3.700132661512924*^9}, {3.700132712565907*^9, 
   3.70013274243123*^9}, {3.70013279608486*^9, 3.700132801191573*^9}, 
   3.700132850877378*^9, 3.700133298849769*^9, 3.700134338929433*^9, 
   3.700134874555071*^9, {3.700153167052483*^9, 3.700153188381577*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.700130413476029*^9, {3.700131660606151*^9, 3.700131664191111*^9}, {
   3.700131696757243*^9, 3.700131736836091*^9}, 3.700132669915906*^9},
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"denominator", " ", "=", " ", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"expr", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[Epsilon]"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.700132886368294*^9, 3.7001329159505787`*^9}, {
  3.7001343410394897`*^9, 3.7001343435539618`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "ay"}], " ", "bx"}], "+", 
  RowBox[{"ax", " ", "by"}], "+", 
  RowBox[{"ay", " ", "cx"}], "-", 
  RowBox[{"by", " ", "cx"}], "-", 
  RowBox[{"ax", " ", "cy"}], "+", 
  RowBox[{"bx", " ", "cy"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "ay"}], "+", "by"}], ")"}], " ", "\[Epsilon]"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"ax", "-", "bx"}], ")"}], " ", 
   SuperscriptBox["\[Epsilon]", "2"]}]}]], "Output",
 CellChangeTimes->{{3.700132882306005*^9, 3.700132917836256*^9}, 
   3.7001343440844727`*^9, 3.700134874593012*^9, {3.7001531671375027`*^9, 
   3.700153188850608*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"transformationRuleToEquation", "[", "rule_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"rule", " ", "/.", 
      RowBox[{"Rule", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"#2", "&"}], ")"}]}]}], ")"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"rule", " ", "/.", 
      RowBox[{"Rule", "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"#2", "&"}], ")"}]}]}], ")"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.700146531602962*^9, 3.700146566543672*^9}, 
   3.70014660111915*^9},
 NumberMarks->False],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.70013041518573*^9, 3.700130415750009*^9}, {
   3.700134593664918*^9, 3.700134603009433*^9}, {3.70014393241601*^9, 
   3.700143956934039*^9}, 3.700146526820245*^9, {3.7001465714012127`*^9, 
   3.700146579491506*^9}, 3.700146649605921*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.70013041518573*^9, 3.700130415750009*^9}, {
  3.700134593664918*^9, 3.700134603009433*^9}, {3.70014393241601*^9, 
  3.700143956934039*^9}, {3.700146526820245*^9, 3.7001465284913807`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "dz", " ", "will", " ", "only", " ", "be", " ", "real", " ", "if", " ", 
    "the", " ", "power", " ", "of", " ", "epsilon", " ", "3", " ", "is", " ", 
    "0"}], "..."}], "*)"}]], "Input",
 CellChangeTimes->{{3.70013041518573*^9, 3.700130415750009*^9}, {
  3.700134593664918*^9, 3.700134603009433*^9}, {3.70014393241601*^9, 
  3.700143956934039*^9}, {3.700146526820245*^9, 3.7001465284913807`*^9}}],

Cell[BoxData[
 RowBox[{"e3Is0", " ", "=", " ", 
  RowBox[{"Solve", "[", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoefficientList", "[", 
       RowBox[{"numerator", ",", " ", "\[Epsilon]"}], "]"}], "[", 
      RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", " ", 
    RowBox[{"{", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.70013041518573*^9, 3.700130415750009*^9}, {
  3.700134593664918*^9, 3.700134603009433*^9}, {3.70014393241601*^9, 
  3.700143935431127*^9}, {3.700143972213501*^9, 3.700144017312538*^9}, {
  3.700144120305951*^9, 3.700144124055393*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"dy", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "ay"}], " ", "cx"}], "+", 
       RowBox[{"by", " ", "cx"}], "+", 
       RowBox[{"ax", " ", "cy"}], "-", 
       RowBox[{"bx", " ", "cy"}], "+", 
       RowBox[{"ay", " ", "dx"}], "-", 
       RowBox[{"by", " ", "dx"}]}], 
      RowBox[{"ax", "-", "bx"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bx", "\[Rule]", "ax"}], ",", 
     RowBox[{"by", "\[Rule]", "ay"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bx", "\[Rule]", "ax"}], ",", 
     RowBox[{"dx", "\[Rule]", "cx"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.700143976010436*^9, 3.700144017816141*^9}, 
   3.700144124531885*^9, {3.7001531672571793`*^9, 3.700153189227353*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.70013041518573*^9, 3.700130415750009*^9}, {
  3.700134593664918*^9, 3.700134603009433*^9}, {3.70014393241601*^9, 
  3.700143935431127*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solution", " ", "=", " ", 
  RowBox[{"Solve", "[", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoefficientList", "[", 
       RowBox[{"numerator", ",", " ", "\[Epsilon]"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "4"}], "]"}], "]"}], " ", "\[Equal]", " ", "0"}], 
    ",", 
    RowBox[{"{", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.700130446366371*^9, 3.700130469740024*^9}, {
   3.70013068075592*^9, 3.700130685995163*^9}, {3.700134199657446*^9, 
   3.7001342425388737`*^9}, {3.700134608598238*^9, 3.700134610311103*^9}, {
   3.700134834600708*^9, 3.700134858240704*^9}, {3.7001367984167547`*^9, 
   3.700136806156479*^9}, 3.700141350632962*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bx", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "az"}], " ", "cx"}], "+", 
        RowBox[{"bz", " ", "cx"}], "+", 
        RowBox[{"ax", " ", "cz"}], "+", 
        RowBox[{"az", " ", "dx"}], "-", 
        RowBox[{"bz", " ", "dx"}]}], "cz"]}], ",", 
     RowBox[{"by", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "az"}], " ", "cy"}], "+", 
        RowBox[{"bz", " ", "cy"}], "+", 
        RowBox[{"ay", " ", "cz"}], "+", 
        RowBox[{"az", " ", "dy"}], "-", 
        RowBox[{"bz", " ", "dy"}]}], "cz"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bx", "\[Rule]", "ax"}], ",", 
     RowBox[{"by", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "az"}], " ", "cy"}], "+", 
        RowBox[{"bz", " ", "cy"}], "+", 
        RowBox[{"ay", " ", "cz"}], "+", 
        RowBox[{"az", " ", "dy"}], "-", 
        RowBox[{"bz", " ", "dy"}]}], "cz"]}], ",", 
     RowBox[{"cx", "\[Rule]", "dx"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"by", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"ay", " ", "cx"}], "-", 
        RowBox[{"ax", " ", "cy"}], "+", 
        RowBox[{"bx", " ", "cy"}], "-", 
        RowBox[{"ay", " ", "dx"}], "+", 
        RowBox[{"ax", " ", "dy"}], "-", 
        RowBox[{"bx", " ", "dy"}]}], 
       RowBox[{"cx", "-", "dx"}]]}], ",", 
     RowBox[{"bz", "\[Rule]", "az"}], ",", 
     RowBox[{"cz", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"cx", "\[Rule]", "dx"}], ",", 
     RowBox[{"cy", "\[Rule]", "dy"}], ",", 
     RowBox[{"cz", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bx", "\[Rule]", "ax"}], ",", 
     RowBox[{"bz", "\[Rule]", "az"}], ",", 
     RowBox[{"cx", "\[Rule]", "dx"}], ",", 
     RowBox[{"cz", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bz", "\[Rule]", "az"}], ",", 
     RowBox[{"cx", "\[Rule]", "dx"}], ",", 
     RowBox[{"cy", "\[Rule]", "dy"}], ",", 
     RowBox[{"cz", "\[Rule]", "0"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7001342431303053`*^9, 3.700134611128927*^9, {3.700134840683176*^9, 
   3.700134874702632*^9}, 3.700136807055551*^9, 3.7001413514892607`*^9, {
   3.700153167518977*^9, 3.7001531894491377`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkIfParallel", "[", "0", "]"}], "  ", "/.", " ", 
   RowBox[{"Join", "[", " ", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"dz", "->", " ", 
       RowBox[{"FullSimplify", "[", " ", 
        RowBox[{"expr", "  ", "/.", " ", 
         RowBox[{"e3Is0", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], " ", "]"}]}], " ", "}"}], ",", 
     " ", 
     RowBox[{"e3Is0", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], " ", "]"}]}], "\[IndentingNewLine]"}]],\
 "Input",
 CellChangeTimes->{{3.700130471591723*^9, 3.700130471600383*^9}, {
   3.7001306497793293`*^9, 3.700130657823202*^9}, 3.700130963593624*^9, {
   3.70013435122845*^9, 3.700134404963032*^9}, 3.700134721957553*^9, {
   3.70013568730449*^9, 3.700135734831493*^9}, {3.7001367753209248`*^9, 
   3.7001368518819923`*^9}, {3.7001377172383204`*^9, 
   3.7001377207788143`*^9}, {3.700141223456004*^9, 3.70014123051591*^9}, {
   3.700141370983582*^9, 3.700141371194508*^9}, {3.700141613555682*^9, 
   3.700141614261057*^9}, 3.7001417565042763`*^9, {3.700144134219181*^9, 
   3.70014415723805*^9}, {3.700144294250287*^9, 3.700144340916606*^9}, {
   3.700144385897149*^9, 3.700144396220233*^9}, 3.700144658764286*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "az"}], " ", "cy"}], "+", 
    RowBox[{"bz", " ", "cy"}], "+", 
    RowBox[{"ay", " ", "cz"}], "-", 
    RowBox[{"by", " ", "cz"}], "-", 
    FractionBox[
     RowBox[{"ay", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ay", "-", "by"}], ")"}], " ", "cz"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"az", "-", "bz"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"cy", "-", "dy"}], ")"}]}]}], ")"}]}], 
     RowBox[{"ay", "-", "by"}]], "+", 
    FractionBox[
     RowBox[{"by", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"ay", "-", "by"}], ")"}], " ", "cz"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"az", "-", "bz"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"cy", "-", "dy"}], ")"}]}]}], ")"}]}], 
     RowBox[{"ay", "-", "by"}]], "+", 
    RowBox[{"az", " ", "dy"}], "-", 
    RowBox[{"bz", " ", "dy"}]}], ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.700144341409176*^9, 3.700144397012*^9, {3.700153167609029*^9, 
   3.700153189571945*^9}}],

Cell["", "Item",
 CellChangeTimes->{{3.7001412059790287`*^9, 3.700141207611669*^9}, {
  3.7001445748302593`*^9, 3.700144577372425*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
      "There", " ", "are", " ", "3", " ", "ways", " ", "to", " ", "make", " ",
        "e3", " ", "0"}], "..."}], " ", "if", " ", "e3", " ", "is", " ", 
     "0"}], ",", " ", 
    RowBox[{
     RowBox[{"then", " ", "the", " ", "values", " ", "of", " ", "dz", " ", 
      RowBox[{"(", 
       RowBox[{"using", " ", "option", " ", "1"}], ")"}], " ", "will", " ", 
      "be"}], "..."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", " ", 
   RowBox[{"expr", "  ", "/.", " ", 
    RowBox[{"e3Is0", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}]}]], "Input",
 CellChangeTimes->{{3.700136828015956*^9, 3.700136855596981*^9}, {
  3.700144477548896*^9, 3.700144514482317*^9}, {3.70014454477627*^9, 
  3.700144629140403*^9}},
 NumberMarks->False],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"ax", "-", "bx"}], ")"}], " ", "cz"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"az", "-", "bz"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"cx", "-", "dx"}], ")"}]}]}], 
  RowBox[{"ax", "-", "bx"}]]], "Output",
 CellChangeTimes->{{3.700144491159787*^9, 3.700144515313347*^9}, {
   3.700144548522811*^9, 3.7001445519109297`*^9}, 3.700144583222087*^9, {
   3.700153167783187*^9, 3.700153189697907*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.700136828015956*^9, 3.700136855596981*^9}, {
  3.700144477548896*^9, 3.700144479179739*^9}},
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "We", " ", "have", " ", "to", " ", "check", " ", "if", " ", "one", " ", 
     "of", " ", "these", " ", "ways", " ", "is", " ", "compatible", " ", 
     "with", " ", "the", " ", "numerator", " ", "being", " ", "k", " ", 
     "times", " ", "the", " ", "denominator"}], ",", " ", 
    RowBox[{
     RowBox[{"for", " ", "the", " ", "other", " ", 
      RowBox[{"coefficients", ".", " ", "We"}], " ", "can", " ", "find", " ", 
      "k", " ", "by", " ", "dividing", " ", "the", " ", "order", " ", "0"}], 
     "..."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"k", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{"numerator", ",", " ", "\[Epsilon]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", " ", 
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{"denominator", ",", " ", "\[Epsilon]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.700136828015956*^9, 3.700136855596981*^9}, {
  3.700144477548896*^9, 3.700144479344533*^9}, {3.7001446609565268`*^9, 
  3.700144672928393*^9}, {3.700144765122958*^9, 3.7001448563980427`*^9}, {
  3.7001448930679493`*^9, 3.700144950112012*^9}},
 NumberMarks->False],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"ay", " ", "bz", " ", "cx"}], "+", 
   RowBox[{"az", " ", "bx", " ", "cy"}], "-", 
   RowBox[{"ax", " ", "bz", " ", "cy"}], "-", 
   RowBox[{"ay", " ", "bx", " ", "cz"}], "+", 
   RowBox[{"ax", " ", "by", " ", "cz"}], "-", 
   RowBox[{"ay", " ", "bz", " ", "dx"}], "-", 
   RowBox[{"az", " ", "cy", " ", "dx"}], "+", 
   RowBox[{"bz", " ", "cy", " ", "dx"}], "+", 
   RowBox[{"ay", " ", "cz", " ", "dx"}], "-", 
   RowBox[{"by", " ", "cz", " ", "dx"}], "+", 
   RowBox[{"az", " ", "by", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "cx"}], "+", "dx"}], ")"}]}], "-", 
   RowBox[{"az", " ", "bx", " ", "dy"}], "+", 
   RowBox[{"ax", " ", "bz", " ", "dy"}], "+", 
   RowBox[{"az", " ", "cx", " ", "dy"}], "-", 
   RowBox[{"bz", " ", "cx", " ", "dy"}], "-", 
   RowBox[{"ax", " ", "cz", " ", "dy"}], "+", 
   RowBox[{"bx", " ", "cz", " ", "dy"}]}], 
  RowBox[{
   RowBox[{
    RowBox[{"-", "ay"}], " ", "bx"}], "+", 
   RowBox[{"ax", " ", "by"}], "+", 
   RowBox[{"ay", " ", "cx"}], "-", 
   RowBox[{"by", " ", "cx"}], "-", 
   RowBox[{"ax", " ", "cy"}], "+", 
   RowBox[{"bx", " ", "cy"}]}]]], "Output",
 CellChangeTimes->{{3.700144827322279*^9, 3.700144856765424*^9}, 
   3.700144912222041*^9, {3.7001531679593697`*^9, 3.7001531898543577`*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.700144813198306*^9, 3.700144813215921*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"coefficientsAreMultipleKAndE3Is0", " ", "=", " ", 
  RowBox[{"Solve", "[", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"CoefficientList", "[", 
          RowBox[{"numerator", ",", " ", "\[Epsilon]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/", " ", 
        RowBox[{
         RowBox[{"CoefficientList", "[", 
          RowBox[{"denominator", ",", " ", "\[Epsilon]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], " ", "\[Equal]", "k"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"CoefficientList", "[", 
          RowBox[{"numerator", ",", " ", "\[Epsilon]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "/", " ", 
        RowBox[{
         RowBox[{"CoefficientList", "[", 
          RowBox[{"denominator", ",", " ", "\[Epsilon]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "\[Equal]", "k"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"CoefficientList", "[", 
         RowBox[{"numerator", ",", " ", "\[Epsilon]"}], "]"}], "[", 
        RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
    RowBox[{"{", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.700136828015956*^9, 3.700136855596981*^9}, {
  3.700144477548896*^9, 3.700144479497388*^9}, {3.700144972060548*^9, 
  3.70014499640212*^9}, {3.7001450846197844`*^9, 3.7001450898239613`*^9}, {
  3.700146764348116*^9, 3.700146765522484*^9}, {3.700146813726728*^9, 
  3.7001468169696093`*^9}, {3.700146934942075*^9, 3.7001469824189262`*^9}, {
  3.700147075423457*^9, 3.700147078109383*^9}, {3.7001477127642*^9, 
  3.700147714423244*^9}, {3.700162159084868*^9, 3.70016218033602*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"dy", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "ay"}], " ", "cx"}], "+", 
       RowBox[{"by", " ", "cx"}], "+", 
       RowBox[{"ax", " ", "cy"}], "-", 
       RowBox[{"bx", " ", "cy"}], "+", 
       RowBox[{"ay", " ", "dx"}], "-", 
       RowBox[{"by", " ", "dx"}]}], 
      RowBox[{"ax", "-", "bx"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bx", "\[Rule]", "ax"}], ",", 
     RowBox[{"dx", "\[Rule]", "cx"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7001449971857147`*^9, 3.700145090494216*^9, 3.700146767006608*^9, 
   3.7001468174099903`*^9, 3.70014693844867*^9, 3.700146984623398*^9, {
   3.700147079365947*^9, 3.700147094502757*^9}, 3.7001477155863132`*^9, {
   3.700153168066608*^9, 3.7001531907299643`*^9}, {3.7001621640525427`*^9, 
   3.700162181355105*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
  "We", " ", "need", " ", "to", " ", "check", " ", "if", " ", "these", " ", 
   "possibilities", " ", "for", " ", "having", " ", "a", " ", "k", " ", "and",
    " ", "coefficient", " ", "of", "  ", 
   RowBox[{"e", "^", "3"}], " ", "being", " ", "0", " ", "are", " ", 
   "compatible", " ", 
   RowBox[{"with", ":", " ", 
    RowBox[{"dIsOnPlane", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"it", " ", "is"}], "..."}], " ", "it", " ", "came", " ", 
       "from", " ", "this", " ", "formula"}], ")"}], " ", "and", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "lines", " ", "not", " ", "being", " ", "parallel", " ", "or", " ", 
        "points", " ", "coincident"}], ")"}], " ", "."}]}]}]}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.700136828015956*^9, 3.700136855596981*^9}, {
  3.700144477548896*^9, 3.7001444796235027`*^9}, {3.700145019505796*^9, 
  3.700145056086622*^9}, {3.7001452506815367`*^9, 3.700145277827738*^9}, {
  3.70014678498028*^9, 3.700146807976268*^9}, {3.700147017901132*^9, 
  3.700147043298601*^9}, {3.7001492371871033`*^9, 3.700149243916194*^9}},
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"option1", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", "  ", 
   RowBox[{"expr", " ", "/.", " ", 
    RowBox[{"coefficientsAreMultipleKAndE3Is0", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], "  "}]], "Input",
 CellChangeTimes->{{3.700136828015956*^9, 3.700136855596981*^9}, {
   3.700144477548896*^9, 3.700144480049*^9}, {3.700145320624655*^9, 
   3.700145396574533*^9}, {3.700145459841179*^9, 3.700145460147647*^9}, {
   3.700146431440463*^9, 3.700146439961569*^9}, {3.700146849877181*^9, 
   3.700146858184157*^9}, {3.7001468884830017`*^9, 3.700146902013938*^9}, {
   3.700147407207308*^9, 3.700147455646975*^9}, {3.700147635995455*^9, 
   3.700147657331262*^9}, 3.700147738817793*^9, {3.7001481986481133`*^9, 
   3.700148231771163*^9}, {3.7001483905223627`*^9, 3.7001483998182163`*^9}, {
   3.7001484331489143`*^9, 3.7001484394776583`*^9}, {3.700148487386199*^9, 
   3.700148487598433*^9}, {3.700148531952118*^9, 3.700148536605775*^9}, 
   3.700148631151772*^9, {3.700148912106949*^9, 3.700148919743373*^9}, 
   3.70015330886446*^9},
 NumberMarks->False],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"ax", "-", "bx"}], ")"}], " ", "cz"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"az", "-", "bz"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"cx", "-", "dx"}], ")"}]}]}], 
  RowBox[{"ax", "-", "bx"}]]], "Output",
 CellChangeTimes->{{3.700147433404882*^9, 3.7001474560619307`*^9}, {
   3.7001476388006687`*^9, 3.700147657956379*^9}, 3.700147739435779*^9, {
   3.700148206858046*^9, 3.700148232438243*^9}, 3.700148400386194*^9, 
   3.700148440089937*^9, 3.700148488576378*^9, 3.700148537357648*^9, 
   3.7001486320199547`*^9, 3.700148922001779*^9, {3.700153168306929*^9, 
   3.700153190861143*^9}, 3.700153310126638*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"option2", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", "  ", 
   RowBox[{"expr", " ", "/.", " ", 
    RowBox[{"coefficientsAreMultipleKAndE3Is0", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}], " "}]], "Input",
 CellChangeTimes->{{3.700136828015956*^9, 3.700136855596981*^9}, {
  3.700144477548896*^9, 3.7001444801815643`*^9}, {3.700146908709832*^9, 
  3.700146910107664*^9}, {3.700148363395935*^9, 3.700148370386653*^9}, {
  3.7001533148738337`*^9, 3.7001533150651503`*^9}, {3.700160631435948*^9, 
  3.70016063447703*^9}},
 NumberMarks->False],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"ay", "-", "by"}], ")"}], " ", "cz"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"az", "-", "bz"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"cy", "-", "dy"}], ")"}]}]}], 
  RowBox[{"ay", "-", "by"}]]], "Output",
 CellChangeTimes->{
  3.7001469129947844`*^9, {3.70014836729923*^9, 3.700148371382806*^9}, {
   3.7001531683504057`*^9, 3.70015319098524*^9}, 3.700153315713694*^9, 
   3.700160635008154*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.700136828015956*^9, 3.700136855596981*^9}, {
   3.700144477548896*^9, 3.7001444801815643`*^9}, 3.700148641736651*^9},
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"willBeParallel", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"checkIfParallel", "[", "0", "]"}], " ", "/.", " ", 
        RowBox[{"coefficientsAreMultipleKAndE3Is0", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "\[Equal]", "0"}], " ", ",",
      " ", "dz"}], "]"}], " ", "]"}]}]], "Input",
 CellChangeTimes->{{3.700136828015956*^9, 3.700136855596981*^9}, {
   3.700144477548896*^9, 3.7001444801815643`*^9}, {3.700148641736651*^9, 
   3.700148720845283*^9}, {3.700148765231369*^9, 3.7001487670755663`*^9}, {
   3.7001489713286333`*^9, 3.7001489743027887`*^9}, 3.700153322382861*^9, {
   3.7001620751171017`*^9, 3.7001620814219418`*^9}, {3.700162229436304*^9, 
   3.700162278084989*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"dz", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ax", "-", "bx"}], ")"}], " ", "cz"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"az", "-", "bz"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"cx", "-", "dx"}], ")"}]}]}], 
     RowBox[{"ax", "-", "bx"}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.7001486508540583`*^9, 3.700148681427938*^9}, 
   3.700148721494574*^9, 3.700148767905818*^9, 3.700148974743528*^9, {
   3.700153168392522*^9, 3.7001531911856947`*^9}, 3.7001533231230993`*^9, {
   3.700162075736803*^9, 3.7001620825079927`*^9}, 3.700162278787567*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7001486706862392`*^9, 3.7001486715876713`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"willBeParallel2", " ", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Solve", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"checkIfParallel", "[", "0", "]"}], " ", "/.", " ", 
        RowBox[{"coefficientsAreMultipleKAndE3Is0", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "\[Equal]", "0"}], " ", ",",
      " ", "dz"}], "]"}], " ", "]"}]}]], "Input",
 CellChangeTimes->{{3.700148978604739*^9, 3.700148984805711*^9}, {
  3.70015324623105*^9, 3.700153296345104*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"dz", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"ay", "-", "by"}], ")"}], " ", "cz"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"az", "-", "bz"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"cy", "-", "dy"}], ")"}]}]}], 
     RowBox[{"ay", "-", "by"}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.700148985495227*^9, {3.700153168466465*^9, 3.7001531913088303`*^9}, {
   3.700153272161256*^9, 3.700153328016601*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.700136828015956*^9, 3.700136855596981*^9}, {
  3.700144477548896*^9, 3.7001444801815643`*^9}, {3.700148641736651*^9, 
  3.700148644612856*^9}},
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"checkIfParallel", "[", "0", "]"}], "  ", "/.", " ", 
    RowBox[{"dz", "\[Rule]", " ", "option1"}]}], ")"}], " ", "]"}]], "Input",
 CellChangeTimes->{{3.7001489887417297`*^9, 3.700148997488803*^9}, {
  3.700162090919211*^9, 3.700162105853162*^9}, {3.7001622913009777`*^9, 
  3.7001623477625103`*^9}, {3.7001623845690117`*^9, 3.7001624507013683`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"az", "-", "bz"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ay", "-", "by"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"cx", "-", "dx"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ax", "-", "bx"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"cy", "-", "dy"}], ")"}]}]}], ")"}]}], 
    RowBox[{"ax", "-", "bx"}]], ",", "0", ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"ay", "-", "by"}], ")"}]}], " ", 
     RowBox[{"(", 
      RowBox[{"cx", "-", "dx"}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"ax", "-", "bx"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"cy", "-", "dy"}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7001624165402927`*^9, 3.700162451159533*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.700162413114546*^9, 3.700162413786374*^9}, {
  3.700162462136849*^9, 3.700162474318316*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "az"}], " ", "cy"}], "+", 
    RowBox[{"bz", " ", "cy"}], "+", 
    RowBox[{"ay", " ", "cz"}], "-", 
    RowBox[{"by", " ", "cz"}], "+", 
    RowBox[{"az", " ", "dy"}], "-", 
    RowBox[{"bz", " ", "dy"}], "-", 
    RowBox[{"ay", " ", "dz"}], "+", 
    RowBox[{"by", " ", "dz"}]}], ",", 
   RowBox[{
    RowBox[{"az", " ", "cx"}], "-", 
    RowBox[{"bz", " ", "cx"}], "-", 
    RowBox[{"ax", " ", "cz"}], "+", 
    RowBox[{"bx", " ", "cz"}], "-", 
    RowBox[{"az", " ", "dx"}], "+", 
    RowBox[{"bz", " ", "dx"}], "+", 
    RowBox[{"ax", " ", "dz"}], "-", 
    RowBox[{"bx", " ", "dz"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "ay"}], " ", "cx"}], "+", 
    RowBox[{"by", " ", "cx"}], "+", 
    RowBox[{"ax", " ", "cy"}], "-", 
    RowBox[{"bx", " ", "cy"}], "+", 
    RowBox[{"ay", " ", "dx"}], "-", 
    RowBox[{"by", " ", "dx"}], "-", 
    RowBox[{"ax", " ", "dy"}], "+", 
    RowBox[{"bx", " ", "dy"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.70014899801285*^9, {3.7001531686700487`*^9, 3.7001531914872637`*^9}, {
   3.70016209148806*^9, 3.700162106809203*^9}, {3.700162292935705*^9, 
   3.7001623023041553`*^9}, {3.7001623447365227`*^9, 3.7001623481998167`*^9}, 
   3.700162402290083*^9, 3.7001624627897053`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.700136828015956*^9, 3.700136855596981*^9}, {
  3.700144477548896*^9, 3.7001444801815643`*^9}, {3.700148641736651*^9, 
  3.700148644841586*^9}},
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"checkIfParallel", "[", "0", "]"}], "\[Equal]", "0"}], " ", "]"}],
   "  "}]], "Input",
 CellChangeTimes->{{3.7001498367940598`*^9, 3.700149938687368*^9}, {
   3.7001499791795073`*^9, 3.7001499881113367`*^9}, {3.7001500218415413`*^9, 
   3.700150027015256*^9}, {3.700150101416066*^9, 3.7001501484263477`*^9}, {
   3.7001510087573223`*^9, 3.700151017900799*^9}, 3.700153200634017*^9, {
   3.700161982085328*^9, 3.70016200326633*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dy", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "ay"}], " ", "cx"}], "+", 
        RowBox[{"by", " ", "cx"}], "+", 
        RowBox[{"ax", " ", "cy"}], "-", 
        RowBox[{"bx", " ", "cy"}], "+", 
        RowBox[{"ay", " ", "dx"}], "-", 
        RowBox[{"by", " ", "dx"}]}], 
       RowBox[{"ax", "-", "bx"}]]}], ",", 
     RowBox[{"dz", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "az"}], " ", "cx"}], "+", 
        RowBox[{"bz", " ", "cx"}], "+", 
        RowBox[{"ax", " ", "cz"}], "-", 
        RowBox[{"bx", " ", "cz"}], "+", 
        RowBox[{"az", " ", "dx"}], "-", 
        RowBox[{"bz", " ", "dx"}]}], 
       RowBox[{"ax", "-", "bx"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bx", "\[Rule]", "ax"}], ",", 
     RowBox[{"by", "\[Rule]", "ay"}], ",", 
     RowBox[{"bz", "\[Rule]", "az"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bx", "\[Rule]", "ax"}], ",", 
     RowBox[{"dx", "\[Rule]", "cx"}], ",", 
     RowBox[{"dz", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "az"}], " ", "cy"}], "+", 
        RowBox[{"bz", " ", "cy"}], "+", 
        RowBox[{"ay", " ", "cz"}], "-", 
        RowBox[{"by", " ", "cz"}], "+", 
        RowBox[{"az", " ", "dy"}], "-", 
        RowBox[{"bz", " ", "dy"}]}], 
       RowBox[{"ay", "-", "by"}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"bx", "\[Rule]", "ax"}], ",", 
     RowBox[{"by", "\[Rule]", "ay"}], ",", 
     RowBox[{"dx", "\[Rule]", "cx"}], ",", 
     RowBox[{"dy", "\[Rule]", "cy"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7001498601838093`*^9, 3.700149939104349*^9}, 
   3.700149988521757*^9, 3.70015002767665*^9, {3.7001501020274477`*^9, 
   3.7001501189456043`*^9}, 3.700150150132128*^9, 3.700151018451579*^9, {
   3.700153168713427*^9, 3.700153201176091*^9}, {3.700161993869459*^9, 
   3.700162003794039*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Det", "[", 
   RowBox[{"checkCoPlanar", "[", "0", "]"}], "]"}], " ", "/.", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ax", "\[Rule]", "0"}], ",", 
    RowBox[{"ay", "\[Rule]", "0"}], ",", 
    RowBox[{"az", "\[Rule]", "0"}], ",", 
    RowBox[{"bx", "\[Rule]", "0"}], ",", 
    RowBox[{"by", "\[Rule]", "1"}], ",", 
    RowBox[{"bz", "\[Rule]", "0"}], ",", 
    RowBox[{"cx", "\[Rule]", "0"}], ",", 
    RowBox[{"cy", "\[Rule]", "0"}], ",", 
    RowBox[{"dx", "\[Rule]", "0"}], ",", 
    RowBox[{"dy", "\[Rule]", "1"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.700136828015956*^9, 3.700136855596981*^9}, {
  3.700144477548896*^9, 3.7001444801815643`*^9}, {3.700148641736651*^9, 
  3.700148645071453*^9}, {3.700150732091433*^9, 3.700150790325884*^9}, {
  3.700150822788045*^9, 3.700150828573805*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  RowBox[{"cz", " ", "\[Epsilon]"}], "-", 
  RowBox[{"dz", " ", "\[Epsilon]"}]}]], "Output",
 CellChangeTimes->{{3.700150763562749*^9, 3.7001507909647827`*^9}, 
   3.7001508295915527`*^9, {3.7001531687447023`*^9, 3.700153191727701*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.700136828015956*^9, 3.700136855596981*^9}, {
  3.700144477548896*^9, 3.7001444801815643`*^9}, {3.700148641736651*^9, 
  3.700148645071453*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
        "In", " ", "what", " ", "situations", " ", "can", " ", "the", " ", 
         "4", " ", "points", " ", "be", " ", "co"}], "-", 
        RowBox[{"planar", "?"}]}], ".."}], " ", "situations", " ", "where", 
      " ", "dz", " ", "is", " ", "0"}], ":", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Solution", "[", "3", "]"}], " ", "--"}], ">", " ", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Solution", "[", "4", "]"}], " ", "--"}], ">", " ", "d"}]}], 
    "=", "c"}], ",", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"solution", "[", "5", "]"}], " ", "--"}], ">", " ", "a"}], "=", 
    "b"}], ",", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solution", "[", "6", "]"}], " ", "\[Rule]", " ", 
    RowBox[{"0", " ", 
     RowBox[{"(", "parallel", ")"}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7001417057755833`*^9, 3.700141752904483*^9}, {
  3.7001418073000937`*^9, 3.700141823081615*^9}, {3.700141920011785*^9, 
  3.700141962882922*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.700130600746483*^9, 3.700130616961739*^9}, {
   3.700130695437317*^9, 3.7001307052732267`*^9}, {3.700130745318001*^9, 
   3.700130761586773*^9}, {3.700130880383197*^9, 3.700130886925879*^9}, {
   3.7001309315858727`*^9, 3.7001309621666594`*^9}, {3.7001369804549313`*^9, 
   3.700137006608889*^9}, {3.700141236573724*^9, 3.7001412577407312`*^9}, {
   3.70014129162481*^9, 3.700141303295321*^9}, {3.700141365748562*^9, 
   3.7001413946190023`*^9}, {3.7001416999559383`*^9, 3.7001417608740883`*^9}, 
   3.700141839040017*^9, 3.7001418756695433`*^9, {3.7001470566699657`*^9, 
   3.700147066045381*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.700136206146566*^9, 3.700136286652886*^9}, {
   3.7001363953950872`*^9, 3.700136404139027*^9}, {3.700137429748901*^9, 
   3.7001374760311003`*^9}, {3.700137517261323*^9, 3.7001375228778763`*^9}, 
   3.7001418039168577`*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "can", " ", "each", " ", "term", " ", "of", " ", "the", " ", "numerator", 
    " ", "be", " ", "a", " ", "multiple", " ", "of", " ", "the", " ", 
    "corresponding", " ", "term", " ", "of", " ", "the", " ", 
    RowBox[{"denominator", "?", " ", "\[IndentingNewLine]", "The"}], " ", 
    "numerator", " ", "has", " ", "the", " ", 
    RowBox[{"form", ":", " ", 
     RowBox[{"n0", " ", "+", " ", 
      RowBox[{"n1", " ", "eps"}], " ", "+", " ", 
      RowBox[{"n2", " ", 
       RowBox[{"eps", "^", "2"}]}], " ", "+", " ", 
      RowBox[{"n3", " ", 
       RowBox[{"eps", "^", "3"}], " ", "\[IndentingNewLine]", "The", " ", 
       "denominator", " ", "has", " ", "the", " ", "form"}]}], ":", " ", 
     RowBox[{"d0", " ", "+", " ", 
      RowBox[{"d1", " ", "eps"}], " ", "+", " ", 
      RowBox[{"d2", " ", 
       RowBox[{"eps", "^", "2"}], " ", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "since", " ", "dz", " ", "is", " ", 
       "real"}]}]}]}], ",", " ", 
   RowBox[{
    RowBox[{
    "the", " ", "only", " ", "possibility", " ", "if", " ", "the", " ", 
     "numerator"}], " ", "=", " ", 
    RowBox[{"k", " ", "*", " ", "denominator"}]}], ",", " ", 
   RowBox[{
   "for", " ", "a", " ", "k", " ", "REAL", "\[IndentingNewLine]", "    ", 
    "thus"}], ",", " ", 
   RowBox[{
    RowBox[{"n3", " ", "should", " ", "be", " ", "0", " ", "and", " ", "n2"}],
     " ", "=", " ", 
    RowBox[{"k", " ", "*", " ", "d2"}]}], ",", " ", 
   RowBox[{"n1", " ", "=", " ", 
    RowBox[{"k", "*", "d1"}]}], ",", " ", 
   RowBox[{"n0", " ", "=", " ", 
    RowBox[{"k", "*", "d0", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"k", " ", "can", " ", "be", " ", "0"}], "..."}], ")"}]}]}]}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.700142450507813*^9, 3.700142473008355*^9}, {
   3.700142621792871*^9, 3.7001426843196297`*^9}, 3.7001429622600946`*^9, {
   3.700143578361203*^9, 3.700143638054628*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"checkTerm", "[", "term_", "]"}], "  ", ":=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{"numerator", ",", " ", "\[Epsilon]"}], "]"}], "[", 
     RowBox[{"[", "term", "]"}], "]"}], "/", 
    RowBox[{
     RowBox[{"CoefficientList", "[", 
      RowBox[{"denominator", ",", " ", "\[Epsilon]"}], "]"}], "[", 
     RowBox[{"[", "term", "]"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.700142513913745*^9, 3.700142531252603*^9}, {
  3.7001437380238543`*^9, 3.7001437528989553`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.700143651061718*^9, 3.700143690452837*^9}, {
  3.700143773234832*^9, 3.70014383080301*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.70014830007371*^9, 3.700148307564237*^9}, {
  3.700148345477775*^9, 3.700148360703661*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ExportString", "[", 
  RowBox[{"option2", ",", " ", "\"\<TeX\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.70015846038194*^9, 3.700158467168151*^9}, {
  3.7001585065847063`*^9, 3.7001585083183203`*^9}, {3.700160650646089*^9, 
  3.700160670299103*^9}}],

Cell[BoxData["\<\"%% AMS-LaTeX Created with the Wolfram Language : \
www.wolfram.com\\n\\n\\\\documentclass{article}\\n\\\\usepackage{amsmath, \
amssymb, graphics, \
setspace}\\n\\n\\\\newcommand{\\\\mathsym}[1]{{}}\\n\\\\newcommand{\\\\\
unicode}[1]{{}}\\n\\n\\\\newcounter{mathematicapage}\\n\\\\begin{document}\\n\
\\n\\\\[\\\\frac{(\\\\text{ay}-\\\\text{by}) \
\\\\text{cz}-(\\\\text{az}-\\\\text{bz}) \
(\\\\text{cy}-\\\\text{dy})}{\\\\text{ay}-\\\\text{by}}\\\\]\\n\\n\\\\end{\
document}\\n\"\>"], "Output",
 CellChangeTimes->{
  3.7001584677413588`*^9, 3.700158509251381*^9, {3.7001606515155773`*^9, 
   3.7001606708215*^9}}]
}, Open  ]]
},
WindowSize->{1594, 846},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.4 for Linux x86 (64-bit) (February 25, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 754, 19, 32, "Input"],
Cell[1315, 41, 617, 13, 32, "Input"],
Cell[1935, 56, 296, 7, 32, "Input"],
Cell[2234, 65, 321, 7, 32, "Input"],
Cell[2558, 74, 294, 7, 32, "Input"],
Cell[2855, 83, 270, 6, 32, "Input"],
Cell[3128, 91, 576, 13, 32, "Input"],
Cell[3707, 106, 980, 25, 32, "Input"],
Cell[CellGroupData[{
Cell[4712, 135, 132, 2, 32, "Input"],
Cell[4847, 139, 1011, 26, 37, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5895, 170, 557, 8, 32, "Input"],
Cell[6455, 180, 1067, 32, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7559, 217, 720, 15, 32, "Input"],
Cell[8282, 234, 3721, 90, 87, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12040, 329, 556, 13, 32, "Input"],
Cell[12599, 344, 3450, 85, 87, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16086, 434, 252, 7, 32, "Input"],
Cell[16341, 443, 2731, 77, 82, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19109, 525, 868, 16, 55, "Input"],
Cell[19980, 543, 2554, 69, 56, "Output"]
}, Open  ]],
Cell[22549, 615, 210, 4, 32, "Input"],
Cell[CellGroupData[{
Cell[22784, 623, 345, 9, 32, "Input"],
Cell[23132, 634, 659, 19, 34, "Output"]
}, Open  ]],
Cell[23806, 656, 670, 20, 32, "Input"],
Cell[24479, 678, 286, 4, 32, "Input"],
Cell[24768, 684, 236, 3, 32, "Input"],
Cell[25007, 689, 460, 9, 32, "Input"],
Cell[25470, 700, 592, 13, 32, "Input"],
Cell[26065, 715, 837, 24, 49, "Output"],
Cell[26905, 741, 188, 3, 32, "Input"],
Cell[CellGroupData[{
Cell[27118, 748, 714, 16, 32, "Input"],
Cell[27835, 766, 2433, 70, 89, "Output"]
}, Open  ]],
Cell[30283, 839, 1224, 25, 55, InheritFromParent],
Cell[31510, 866, 1226, 39, 51, "Output"],
Cell[32739, 907, 135, 2, 31, "Item"],
Cell[CellGroupData[{
Cell[32899, 913, 884, 22, 77, "Input"],
Cell[33786, 937, 494, 14, 49, "Output"]
}, Open  ]],
Cell[34295, 954, 162, 3, 32, "Input"],
Cell[CellGroupData[{
Cell[34482, 961, 1294, 28, 77, "Input"],
Cell[35779, 991, 1305, 32, 51, "Output"]
}, Open  ]],
Cell[37099, 1026, 92, 1, 32, InheritFromParent],
Cell[CellGroupData[{
Cell[37216, 1031, 1768, 39, 77, "Input"],
Cell[38987, 1072, 910, 24, 49, "Output"]
}, Open  ]],
Cell[39912, 1099, 1189, 26, 55, "Input"],
Cell[CellGroupData[{
Cell[41126, 1129, 1095, 18, 32, "Input"],
Cell[42224, 1149, 710, 17, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42971, 1171, 579, 11, 32, "Input"],
Cell[43553, 1184, 495, 15, 51, "Output"]
}, Open  ]],
Cell[44063, 1202, 187, 3, 32, "Input"],
Cell[CellGroupData[{
Cell[44275, 1209, 855, 18, 32, "Input"],
Cell[45133, 1229, 701, 18, 49, "Output"]
}, Open  ]],
Cell[45849, 1250, 96, 1, 32, "Input"],
Cell[CellGroupData[{
Cell[45970, 1255, 553, 13, 32, "Input"],
Cell[46526, 1270, 556, 17, 51, "Output"]
}, Open  ]],
Cell[47097, 1290, 213, 4, 32, "Input"],
Cell[CellGroupData[{
Cell[47335, 1298, 436, 8, 32, "Input"],
Cell[47774, 1308, 950, 32, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48761, 1345, 141, 2, 32, "Input"],
Cell[48905, 1349, 1320, 36, 32, "Output"]
}, Open  ]],
Cell[50240, 1388, 213, 4, 32, "Input"],
Cell[CellGroupData[{
Cell[50478, 1396, 505, 10, 32, "Input"],
Cell[50986, 1408, 2049, 57, 91, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53072, 1470, 860, 20, 32, "Input"],
Cell[53935, 1492, 260, 5, 32, "Output"]
}, Open  ]],
Cell[54210, 1500, 213, 4, 32, "Input"],
Cell[54426, 1506, 1172, 31, 121, "Input"],
Cell[55601, 1539, 647, 9, 32, "Input"],
Cell[56251, 1550, 272, 4, 32, "Input"],
Cell[56526, 1556, 1998, 45, 165, "Input"],
Cell[58527, 1603, 591, 14, 32, "Input"],
Cell[59121, 1619, 140, 2, 32, "Input"],
Cell[59264, 1623, 140, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[59429, 1629, 276, 5, 32, "Input"],
Cell[59708, 1636, 632, 11, 341, "Output"]
}, Open  ]]
}
]
*)

